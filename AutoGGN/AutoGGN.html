

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>AutoGGN &mdash; autogenome 1.0 文档</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="autogenome 1.0 文档" href="../index.html"/>
        <link rel="prev" title="AutoOmics" href="../AutoOmics/AutoOmics.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> autogenome
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">AutoGGN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#autoggn">AutoGGN介绍</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#">背景</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#">快速开始</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#">安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="#">使用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#config">Config文件配置详解</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gene-gcn">Gene GCN案例</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#">配置文件</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gpu">GPU版本</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cpu">CPU版本</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#">使用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gpu">GPU版本</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cpu">CPU版本</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#">附录</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">autogenome</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>AutoGGN</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/AutoGGN/AutoGGN.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="autoggn">
<span id="autoggn"></span><h1>AutoGGN<a class="headerlink" href="#autoggn" title="永久链接至标题">¶</a></h1>
<div class="section" id="autoggn">
<span id="id1"></span><h2>AutoGGN介绍<a class="headerlink" href="#autoggn" title="永久链接至标题">¶</a></h2>
<p>AutoGGN是一种利用图卷积神经网络整合生物分子相互作用网络及生物多组学数据的方法”。该方法很好利用生物体内调控网络特性，并整合多组学数据（基因表达、基因点突变、甲基化等组学数据），显著地提升了生物体样本的预测准确率。</p>
<div class="section" id="">
<span id="id2"></span><h3>背景<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<p>近年来生物组学技术快速发展，全基因组测序、转录组测序、Hi-C测序、LC-MS蛋白质组检测等多组学检测技术已经普及到生命科学领域的基础科研、药物研发和精准医疗等众多子领域。利用多组学数据进行更加精准的药物靶点挖掘、癌症相关基因发现等已经成为药物研发公司必备的一类研究项目。但是，生命发育成熟是一个极其复杂的过程，仅仅靠整合不同组学数据依然不能全面地发现生命现象背后的本质。因为，在生物体内的不同组学数据间，组学数据内的基因和基因间（或者代谢物间），普遍存在多样复杂的生物分子相互作用网络。AutoGGN能够整合生物多组学数据和生物体内的分子相互作用网络，从深层次挖掘隐含在生物分子相互作用网络和组学数据背后的生命规律，解决相关的生命科学问题。例如，通过综合蛋白互作网络和基因突变、表达数据等，预测癌症患者的癌症类型，协助患者更好的选择治疗方式、发现致病基因等。</p>
</div>
</div>
<div class="section" id="">
<span id="id3"></span><h2>快速开始<a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
<div class="section" id="">
<span id="id4"></span><h3>安装<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="c1"># Setup environment using conda, env_gpu.yaml for CPU server</span>
conda env create -f env.yaml
conda activate autogdl

<span class="c1">#get test data and install autogdl package</span>
wget https://github.com/EiHealth/EiHealth.github.io/blob/master/data/little_exp.tsv --no-check-certificate
wget https://github.com/EiHealth/EiHealth.github.io/blob/master/data/little_learning_target.tsv --no-check-certificate
pip install autogdl*.whl
</pre></div>
</div>
</div>
<div class="section" id="">
<span id="id5"></span><h3>使用<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># autogenome_biogdl is a branch version of AutoGGN developled to integrate single-omics data and molecular interaction networks</span>
<span class="kn">import</span> <span class="nn">autogenome_biogdl</span> <span class="k">as</span> <span class="nn">ag_gdl</span>

<span class="c1"># create automl instance from a default config file</span>
<span class="n">automl_gdl</span><span class="o">=</span> <span class="n">ag_gdl</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>

<span class="c1"># or from a user-defined config file</span>
<span class="n">automl_gdl</span><span class="o">=</span> <span class="n">ag_gdl</span><span class="o">.</span><span class="n">auto</span><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>

<span class="c1"># train to get the best hyperparameters and a trained model</span>
<span class="n">automl_gdl</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="c1"># evaluate </span>
<span class="n">automl_gdl</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>

<span class="c1"># predict</span>
<span class="n">automl_gdl</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>

<span class="c1"># interprete</span>
<span class="n">automl_gdl</span><span class="o">.</span><span class="n">explain</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="config">
<span id="config"></span><h2>Config文件配置详解<a class="headerlink" href="#config" title="永久链接至标题">¶</a></h2>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>project_name: exp1        // Project name

device:
  gpu_per_instance: 1        // GPU number to use
  cpu_per_instance: 8        // CPU number to use

search_algorithm:
  random_search:        // Algorithm for learning_rate, weight_decay searching
    params:
      - type: discrete_param        // [discrete_param/continuous_param]
        name: learning_rate        // Name of parameter to search
        values: [0.001, 0.002, 0.003, 0.004, 0.005]        // values of parameter to search
      - type: discrete_param
        name: weight_decay
        values: [1e-5, 1e-4, 1e-3]
  mbnas:        // Algorithm for activation, num_layers, embedding_dim, channels searching
    params:
      - type: discrete_param
        name: activation
        values: [&#39;sigmoid&#39;, &#39;relu&#39;]
      - type: discrete_param
        name: num_layers
        values: [2, 3]
      - type: discrete_param
        name: embedding_dim
        values: [8, 16]
      - type: discrete_param
        name: channels
        values: [4, 8, 16]

data:
  data_url: /home/wenshen/auto_gdl/sample_data/small/        // Dataset path
  sample_file: feature        // Features file name for training
  label_file: label        // Labels file name for training
  adjlist: adjlist        // Adjlist file name for training
  test_sample_file: test_x.csv        // Features file name for evaluating
  test_label_file: test_y.csv        // Labels file name for evaluating
  predict_sample_file: test_x.csv        // Features file name for predicting

trainer:
  train_url: /home/wenshen/result        // Dir to save models, logs and output files
  graph_format: adjlist        // [adjlist/pickle]
  save_result: True        // Whether to save results or not
  num_epochs: 10        // Epochs for hyperparams tunning
  seed: 0        // random seed for train/validation split
  aggregation: None        [None/hierarchy/random/kmeans] Aggregation clusting method, used to reduce the number of nodes after each convolution
  agg_reduce: 2        // Aggregation reduce factor
  gating: False        // Whether to add gate layer or not
  dropout: True        // Whether to add Dropout or not
  metrics: acc        // [acc/f1] Evaluation metrics 
  split_spec: 0.8        // Split size of train and validation
  label_dim: 1        // Label dimension
  batch_size: 50        // Batch size
  num_classes: 10        // Number of classes in dataset
  log_every_n_epochs: 1        // Print logs every n epochs
  num_workers: 4        // Number of graph cpnvolution workers

explainer:
  plot_type: bar      // Plot type for feature importance graph
  features_name_file: /home/wenshen/auto_gdl/sample_data/small/gene_names        // Path of features name file
  num_samples: 80        // Number of samples used to calculate shap value
  ranked_outputs: 20        // Number of top features to include in the plot
</pre></div>
</div>
</div>
<div class="section" id="gene-gcn">
<span id="gene-gcn"></span><h2>Gene GCN案例<a class="headerlink" href="#gene-gcn" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="##配置文件">配置文件</a></li>
<li><a class="reference external" href="##使用">使用</a></li>
</ul>
<p>Gene GCN案例以一个十分类任务为例，<code class="docutils literal"><span class="pre">feature</span></code>数据包含9000个samples，5129个features。</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt; wc feature <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span>  <span class="c1"># 打印行数</span>
<span class="m">9000</span>
&gt; <span class="s1">&#39;sed -n &#39;</span><span class="m">1</span>,1p<span class="s1">&#39; feature | awk -F&#39;</span>,<span class="s1">&#39; &#39;</span><span class="o">{</span>print NF-1<span class="o">}</span>  <span class="c1"># 打印列数</span>
<span class="m">5129</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">label</span></code>数据为十类，分别为900。</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt; awk -F<span class="s1">&#39;,&#39;</span> <span class="s1">&#39;{print $2}&#39;</span> label <span class="p">|</span> sort <span class="p">|</span> uniq -c <span class="p">|</span> awk <span class="s1">&#39;{print $2 &quot; &quot; $1}&#39;</span> <span class="c1"># 打印各个类别的样本数</span>
<span class="m">0</span> <span class="m">900</span>
<span class="m">1</span> <span class="m">900</span>
<span class="m">2</span> <span class="m">900</span>
<span class="m">3</span> <span class="m">900</span>
<span class="m">4</span> <span class="m">900</span>
<span class="m">5</span> <span class="m">900</span>
<span class="m">6</span> <span class="m">900</span>
<span class="m">7</span> <span class="m">900</span>
<span class="m">8</span> <span class="m">900</span>
<span class="m">9</span> <span class="m">900</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">adjlist</span></code>数据为features相互作用的邻接表，行分别为5129个feature， 列为与该feature有相互作用关系的其他features。</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>&gt; wc adjlist <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span>   <span class="c1"># 打印行数</span>
<span class="m">5129</span>
</pre></div>
</div>
<div class="section" id="">
<span id="id6"></span><h3>配置文件<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<div class="section" id="gpu">
<span id="gpu"></span><h4>GPU版本<a class="headerlink" href="#gpu" title="永久链接至标题">¶</a></h4>
<p>首先，准备配置文件，具体如下所示：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>project_name: SC980        // Project name

device:
  gpu_per_instance: 1        // GPU number to use
  cpu_per_instance: 8        // CPU number to use

search_algorithm:
  random_search:        // Algorithm for learning_rate, weight_decay searching
    params:
      - type: discrete_param        // [discrete_param/continuous_param]
        name: learning_rate        // Name of parameter to search
        values: [0.001, 0.002, 0.003, 0.004, 0.005]        // values of parameter to search
      - type: discrete_param
        name: weight_decay
        values: [1e-5, 1e-4, 1e-3]
  mbnas:        // Algorithm for activation, num_layers, embedding_dim, channels searching
    params:
      - type: discrete_param
        name: activation
        values: [&#39;sigmoid&#39;, &#39;relu&#39;]
      - type: discrete_param
        name: num_layers
        values: [2, 3]
      - type: discrete_param
        name: embedding_dim
        values: [8, 16]
      - type: discrete_param
        name: channels
        values: [4, 8, 16]

data:
  data_url: /home/wenshen/auto_gdl/sample_data/small/        // Dataset path
  sample_file: feature        // Features file name for training
  label_file: label        // Labels file name for training
  adjlist: adjlist        // Adjlist file name for training
  test_sample_file: test_x.csv        // Features file name for evaluating
  test_label_file: test_y.csv        // Labels file name for evaluating
  predict_sample_file: test_x.csv        // Features file name for predicting

trainer:
  train_url: /home/wenshen/try_res        // Dir to save models, logs and output files
  graph_format: adjlist        // [adjlist/pickle]
  save_result: True        // Whether to save results or not
  num_epochs: 10        // Epochs for hyperparams tunning
  seed: 0        // random seed for train/validation split
  aggregation: None        [None/hierarchy/random/kmeans] Aggregation clusting method, used to reduce the number of nodes after each convolution
  agg_reduce: 2        // Aggregation reduce factor
  gating: False        // Whether to add gate layer or not
  dropout: True        // Whether to add Dropout or not
  metrics: acc        // [acc/f1] Evaluation metrics 
  split_spec: 0.8        // Split size of train and validation
  label_dim: 1        // Label dimension
  batch_size: 50        // Batch size
  num_classes: 10        // Number of classes in dataset
  log_every_n_epochs: 1        // Print logs every n epochs
  num_workers: 4        // Number of graph cpnvolution workers

explainer:
  plot_type: bar      // Plot type for feature importance graph
  features_name_file: /home/wenshen/auto_gdl/sample_data/small/gene_names        // Path of features name file
  num_samples: 500        // Number of samples used to calculate shap value
  ranked_outputs: 20        // Number of top features to include in the plot
</pre></div>
</div>
</div>
<div class="section" id="cpu">
<span id="cpu"></span><h4>CPU版本<a class="headerlink" href="#cpu" title="永久链接至标题">¶</a></h4>
<p>首先，准备配置文件，具体如下所示：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>project_name: SC980        // Project name

device:
  gpu_per_instance: 0        // GPU number to use
  cpu_per_instance: 8        // CPU number to use

search_algorithm:
  random_search:        // Algorithm for learning_rate, weight_decay searching
    params:
      - type: discrete_param        // [discrete_param/continuous_param]
        name: learning_rate        // Name of parameter to search
        values: [0.001, 0.002, 0.003, 0.004, 0.005]        // values of parameter to search
      - type: discrete_param
        name: weight_decay
        values: [1e-5, 1e-4, 1e-3]
  mbnas:        // Algorithm for activation, num_layers, embedding_dim, channels searching
    params:
      - type: discrete_param
        name: activation
        values: [&#39;sigmoid&#39;, &#39;relu&#39;]
      - type: discrete_param
        name: num_layers
        values: [2, 3]
      - type: discrete_param
        name: embedding_dim
        values: [8, 16]
      - type: discrete_param
        name: channels
        values: [4, 8, 16]

data:
  data_url: /home/wenshen/auto_gdl/sample_data/small/        // Dataset path
  sample_file: feature        // Features file name for training
  label_file: label        // Labels file name for training
  adjlist: adjlist        // Adjlist file name for training
  test_sample_file: test_x.csv        // Features file name for evaluating
  test_label_file: test_y.csv        // Labels file name for evaluating
  predict_sample_file: test_x.csv        // Features file name for predicting

trainer:
  train_url: /home/wenshen/try_res        // Dir to save models, logs and output files
  graph_format: adjlist        // [adjlist/pickle]
  save_result: True        // Whether to save results or not
  num_epochs: 10        // Epochs for hyperparams tunning
  seed: 0        // random seed for train/validation split
  aggregation: None        [None/hierarchy/random/kmeans] Aggregation clusting method, used to reduce the number of nodes after each convolution
  agg_reduce: 2        // Aggregation reduce factor
  gating: False        // Whether to add gate layer or not
  dropout: True        // Whether to add Dropout or not
  metrics: acc        // [acc/f1] Evaluation metrics 
  split_spec: 0.8        // Split size of train and validation
  label_dim: 1        // Label dimension
  batch_size: 50        // Batch size
  num_classes: 10        // Number of classes in dataset
  log_every_n_epochs: 1        // Print logs every n epochs
  num_workers: 4        // Number of graph cpnvolution workers

explainer:
  plot_type: bar      // Plot type for feature importance graph
  features_name_file: /home/wenshen/auto_gdl/sample_data/small/gene_names        // Path of features name file
  num_samples: 500        // Number of samples used to calculate shap value
  ranked_outputs: 20        // Number of top features to include in the plot
</pre></div>
</div>
</div>
</div>
<div class="section" id="">
<span id="id7"></span><h3>使用<a class="headerlink" href="#" title="永久链接至标题">¶</a></h3>
<div class="section" id="gpu">
<span id="id8"></span><h4>GPU版本<a class="headerlink" href="#gpu" title="永久链接至标题">¶</a></h4>
<p>AutoGenome-BioGDL的使用主要包含以下几步：</p>
<ol>
<li><p class="first">导入autogenome_biogdl包</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">autogenome_biogdl</span> <span class="k">as</span> <span class="nn">ag_gdl</span>
</pre></div>
</div>
</li>
<li><p class="first">读取配置文件，配置文件如上述所示</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">automl_gdl</span> <span class="o">=</span> <span class="n">ag_gdl</span><span class="o">.</span><span class="n">auto</span><span class="p">(</span><span class="s2">&quot;./GeneGCN_single_cell_expression_ppi.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>配置文件读取成功后，会打印如下日志：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>==========================================================
----------Use the config from ./GeneGCN_single_cell_expression_ppi.yaml
----------Split parameters for autosearch and GDL
----------Build gcn extensions
----------Split yamls for autosearch
==========================================================
#################################################################################
#                                                                               #
#                                                                               #
         Ready to search the best hyper parameters for SC980 GeneGCN model
#                                                                               #
#                                                                               #
#################################################################################
</pre></div>
</div>
</li>
<li><p class="first">训练模型。根据配置文件中训练参数进行模型训练，将数据集划分为训练集:验证集为8:2，使用训练集数据进行训练，同时在验证集数据上进行评估，保存在验证集数据上评价指标（trainer.metrics: &#8220;acc&#8221;）更好的模型和参数到相应文件夹（trainer.train_url: &#8220;/home/wenshen/try_res&#8221;）中的<code class="docutils literal"><span class="pre">models</span></code>文件夹中。</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">automl_gdl</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
<p>训练过程中，使用autosearch搭配两种算法（random search和mbnas）对learning_rate, weight_decay, activation, num_layers, embedding_dim, channels进行最优参数搜索，每一种参数组合会训练一定的epoch数（trainer.num_epochs），挑选结果最好的作为最终模型结构参数并保存，训练过程中在验证集上进行评估。</p>
<p>训练过程中部分日志如下:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>----------In Hyper &amp; Training Search stage
platform.python_version(): 3.6.10
Results writing to local_dir : /mnt/data3/wenshen/SC980/result/autosearch_results/451644f4-fbe7-11ea-a771-b99e3b0f8bf8
Log dir is made: /mnt/data3/wenshen/SC980/result/autosearch_results/451644f4-fbe7-11ea-a771-b99e3b0f8bf8
[2020-09-21 16:48:52,854][search_policy.py: 181][WARNING]  Restore directory missing, AutoSearch will start without warm boot.
{&#39;learning_rate&#39;: 0.005, &#39;weight_decay&#39;: 0.0001}
{&#39;learning_rate&#39;: 0.004, &#39;weight_decay&#39;: 0.001}
{&#39;learning_rate&#39;: 0.004, &#39;weight_decay&#39;: 0.001}
{&#39;learning_rate&#39;: 0.005, &#39;weight_decay&#39;: 0.001}
{&#39;learning_rate&#39;: 0.005, &#39;weight_decay&#39;: 0.0001}
== Status ==
Memory usage on this node: 7.2/62.9 GiB
Using FIFO scheduling algorithm.
Resources requested: 8/8 CPUs, 1/1 GPUs, 0.0/62.89 GiB heap, 0.0/4.3 GiB objects
Result logdir: /mnt/data3/wenshen/SC980/result/autosearch_results/451644f4-fbe7-11ea-a771-b99e3b0f8bf8/ModelartsFunctionRunner
Number of trials: 5 (1 RUNNING, 4 PENDING)
+----------------------------------+----------+-------+----------------+-----------------+
| Trial name                       | status   | loc   | weight_decay   | learning_rate   |
|----------------------------------+----------+-------+----------------+-----------------|
| ModelartsFunctionRunner_46b47e70 | RUNNING  |       |                |                 |
| ModelartsFunctionRunner_46b4b07a | PENDING  |       |                |                 |
| ModelartsFunctionRunner_46b4d7ee | PENDING  |       |                |                 |
| ModelartsFunctionRunner_46b4fd28 | PENDING  |       |                |                 |
| ModelartsFunctionRunner_46b521ea | PENDING  |       |                |                 |
+----------------------------------+----------+-------+----------------+-----------------+
 ...
</pre></div>
</div>
</li>
</ol>
<ol>
<li><p class="first">评估模型。根据上步所训练的模型结构及模型参数，评估在<code class="docutils literal"><span class="pre">data.test_sample_file</span></code>和<code class="docutils literal"><span class="pre">data.test_label_file</span></code>上表现，分类模型输出<code class="docutils literal"><span class="pre">accuracy</span></code>值, <code class="docutils literal"><span class="pre">classification_report</span></code>和<code class="docutils literal"><span class="pre">confusion</span> <span class="pre">matrix</span></code>。</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">automl_gdl</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
</pre></div>
</div>
<p>部分日志如下所示：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="o">----------</span><span class="nx">In</span> <span class="nx">Evaluation</span> <span class="nx">stage</span>
<span class="nx">Restoring</span> <span class="nx">parameters</span> <span class="kr">from</span> <span class="o">/</span><span class="nx">mnt</span><span class="o">/</span><span class="nx">data3</span><span class="o">/</span><span class="nx">wenshen</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="nx">result</span><span class="o">/</span><span class="nx">models</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="mf">0921</span><span class="nx">_164750</span><span class="o">/</span><span class="nx">d465c6d0</span><span class="o">/</span><span class="nx">d465c6d0_model</span><span class="o">/</span><span class="nx">variables</span><span class="o">/</span><span class="nx">variables</span>
<span class="nx">Restoring</span> <span class="nx">parameters</span> <span class="kr">from</span> <span class="o">/</span><span class="nx">mnt</span><span class="o">/</span><span class="nx">data3</span><span class="o">/</span><span class="nx">wenshen</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="nx">result</span><span class="o">/</span><span class="nx">models</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="mf">0921</span><span class="nx">_164750</span><span class="o">/</span><span class="nx">d465c6d0</span><span class="o">/</span><span class="nx">d465c6d0_model</span><span class="o">/</span><span class="nx">variables</span><span class="o">/</span><span class="nx">variables</span>
<span class="nx">metrics</span> <span class="nx">acc</span><span class="o">:</span><span class="mf">0.917</span>
<span class="nx">The</span> <span class="nx">detail</span> <span class="nx">metrics</span> <span class="nx">is</span><span class="o">:</span>
<span class="p">{</span><span class="s1">&#39;0&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.8446601941747572</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.87</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.8571428571428571</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">100</span><span class="p">},</span> <span class="s1">&#39;1&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.9574468085106383</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.9278350515463918</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">100</span><span class="p">},</span> <span class="s1">&#39;2&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.8571428571428571</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.84</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.8484848484848485</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">100</span><span class="p">},</span> <span class="s1">&#39;3&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.9509803921568627</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.97</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.9603960396039604</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">100</span><span class="p">},</span> <span class="s1">&#39;4&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.9583333333333334</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.92</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.9387755102040817</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">100</span><span class="p">},</span> <span class="s1">&#39;5&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.875</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.98</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.9245283018867924</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">100</span><span class="p">},</span> <span class="s1">&#39;6&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.9375</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.9183673469387755</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">100</span><span class="p">},</span> <span class="s1">&#39;7&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.875</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.84</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.8571428571428572</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">100</span><span class="p">},</span> <span class="s1">&#39;8&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.9230769230769231</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.96</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.9411764705882353</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">100</span><span class="p">},</span> <span class="s1">&#39;9&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.9949748743718593</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">100</span><span class="p">},</span> <span class="s1">&#39;accuracy&#39;</span><span class="o">:</span> <span class="mf">0.917</span><span class="p">,</span> <span class="s1">&#39;macro avg&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.9179140508395373</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.917</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.916882415791066</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">1000</span><span class="p">},</span> <span class="s1">&#39;weighted avg&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;precision&#39;</span><span class="o">:</span> <span class="mf">0.9179140508395371</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="o">:</span> <span class="mf">0.917</span><span class="p">,</span> <span class="s1">&#39;f1-score&#39;</span><span class="o">:</span> <span class="mf">0.9168824157910658</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="o">:</span> <span class="mf">1000</span><span class="p">}}</span>
<span class="o">----------</span><span class="nx">Save</span> <span class="nx">evaluation</span> <span class="nx">results</span> <span class="nx">under</span> <span class="o">/</span><span class="nx">mnt</span><span class="o">/</span><span class="nx">data3</span><span class="o">/</span><span class="nx">wenshen</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="nx">result</span><span class="o">/</span><span class="nx">output_files</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="mf">0921</span><span class="nx">_164750</span>
<span class="nx">numexpr</span><span class="p">.</span><span class="nx">utils</span><span class="o">:</span><span class="nx">NumExpr</span> <span class="nx">defaulting</span> <span class="nx">to</span> <span class="mf">8</span> <span class="nx">threads</span><span class="p">.</span>
<span class="nx">Confusion</span> <span class="nx">matrix</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_confusion_matrix.pdf/png&#39;</span>
</pre></div>
</div>
<p>evaluate阶段将输出评估的<code class="docutils literal"><span class="pre">classification_report</span></code>csv文件和<code class="docutils literal"><span class="pre">confusion_matrix</span></code>csv/png/pdf文件，保存到<code class="docutils literal"><span class="pre">output_files</span></code>文件夹中。</p>
<p>得到的confusion matrix图如下所示，图数字大小会根据类别数多少进行调整，x轴为真值，y轴为预测值：</p>
<p><img alt="" src="../_images/SC980_confusion_matrix.png" /></p>
</li>
<li><p class="first">预测数据。根据第3步所训练的模型结构及模型参数，对于给定features数据（<code class="docutils literal"><span class="pre">data.predict_sample_file</span></code>），分类问题预测其类别，并输出到对应的csv文件中。</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">automl_gdl</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
</pre></div>
</div>
<p>日志如下所示：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>----------In Prediction stage
Restoring parameters from /mnt/data3/wenshen/SC980/result/models/SC980/0921_164750/d465c6d0/d465c6d0_model/variables/variables
Restoring parameters from /mnt/data3/wenshen/SC980/result/models/SC980/0921_164750/d465c6d0/d465c6d0_model/variables/variables
----------Save prediction results in /mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_predicted_result_data_frame.csv
</pre></div>
</div>
<p>如日志所示，将输出预测的<code class="docutils literal"><span class="pre">predicted_result_data_frame</span></code>文件，文件第一列为样本名，第二列<code class="docutils literal"><span class="pre">predicted_result</span></code>为预测的类别，其余列为各个类别的log_softmax值。</p>
</li>
<li><p class="first">变量重要性排序。根据第3步所训练的模型结构及模型参数，对变量重要性进行排序，输出各个类别变量重要性，<code class="docutils literal"><span class="pre">explainer</span></code>中需要指定变量名对应的文件。</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">automl_gdl</span><span class="o">.</span><span class="n">explain</span><span class="p">()</span>
</pre></div>
</div>
<p>对模型变量重要性进行排序，输出日志如下：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="o">----------</span><span class="nx">In</span> <span class="nx">explaination</span> <span class="nx">stage</span>
<span class="nx">Restoring</span> <span class="nx">parameters</span> <span class="kr">from</span> <span class="o">/</span><span class="nx">mnt</span><span class="o">/</span><span class="nx">data3</span><span class="o">/</span><span class="nx">wenshen</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="nx">result</span><span class="o">/</span><span class="nx">models</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="mf">0921</span><span class="nx">_164750</span><span class="o">/</span><span class="nx">d465c6d0</span><span class="o">/</span><span class="nx">d465c6d0_model</span><span class="o">/</span><span class="nx">variables</span><span class="o">/</span><span class="nx">variables</span>
<span class="nx">Restoring</span> <span class="nx">parameters</span> <span class="kr">from</span> <span class="o">/</span><span class="nx">mnt</span><span class="o">/</span><span class="nx">data3</span><span class="o">/</span><span class="nx">wenshen</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="nx">result</span><span class="o">/</span><span class="nx">models</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="mf">0921</span><span class="nx">_164750</span><span class="o">/</span><span class="nx">d465c6d0</span><span class="o">/</span><span class="nx">d465c6d0_model</span><span class="o">/</span><span class="nx">variables</span><span class="o">/</span><span class="nx">variables</span>
<span class="nx">Using</span> <span class="nx">TensorFlow</span> <span class="nx">backend</span><span class="p">.</span>
<span class="o">----------</span><span class="nx">Computing</span> <span class="nx">shap_values</span> <span class="kd">with</span> <span class="mf">500</span>  <span class="nx">examples</span> <span class="nx">and</span> <span class="mf">5129</span> <span class="nx">features</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class0_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class1_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class2_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class3_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class4_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class5_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class6_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class7_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class8_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class9_shap_values.csv&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class0_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class1_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class2_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class3_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class4_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class5_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class6_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class7_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class8_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class9_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">features</span> <span class="nx">orders</span> <span class="ow">in</span> <span class="nx">all</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="nx">saved</span> <span class="ow">in</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_features_orders.csv&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class1_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class3_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class6_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class2_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class8_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class0_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class4_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class5_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class7_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class9_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_classTotal_feature_importance_summary_bar.pdf/png&#39;</span>
</pre></div>
</div>
<p>运行结束后将输出各个类别的变量重要性条图和点图和总的变量重要性图，如下所示：</p>
<p>总的变量重要性图：</p>
<p><img alt="" src="../_images/SC980_classTotal_feature_importance_summary_bar.png" /></p>
<p>class 0变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class0_feature_importance_summary.png" /></p>
<p>class 1变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class1_feature_importance_summary.png" /></p>
<p>class 2变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class2_feature_importance_summary.png" /></p>
<p>class 3变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class3_feature_importance_summary.png" /></p>
<p>class 4变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class4_feature_importance_summary.png" /></p>
<p>class 5变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class5_feature_importance_summary.png" /></p>
<p>class 6变量重要性条图：</p>
<p><img alt="" src="../_images/Pancancer-SC980_class6_feature_importance_summary.png" /></p>
<p>class 7变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class7_feature_importance_summary.png" /></p>
<p>class 8变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class8_feature_importance_summary.png" /></p>
<p>class 9变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class9_feature_importance_summary.png" /></p>
<p>class 0变量重要性点图：</p>
<p><img alt="" src="../_images/SC980_class0_feature_importance_summary_dot.png" /></p>
<p>class 1变量重要性点图：
<img alt="" src="../_images/SC980_class1_feature_importance_summary_dot.png" /></p>
<p>class 2变量重要性点图：</p>
<p><img alt="" src="../_images/SC980_class2_feature_importance_summary_dot.png" /></p>
<p>class 3变量重要性点图：
<img alt="" src="../_images/SC980_class3_feature_importance_summary_dot.png" /></p>
<p>class 4变量重要性点图：</p>
<p><img alt="" src="../_images/SC980_class4_feature_importance_summary_dot.png" /></p>
<p>class 5变量重要性点图：
<img alt="" src="../_images/SC980_class5_feature_importance_summary_dot.png" /></p>
<p>class 6变量重要性点图：</p>
<p><img alt="" src="../_images/SC980_class6_feature_importance_summary_dot.png" /></p>
<p>class 7变量重要性点图：
<img alt="" src="../_images/SC980_class7_feature_importance_summary_dot.png" /></p>
<p>class 8变量重要性点图：</p>
<p><img alt="" src="../_images/SC980_class8_feature_importance_summary_dot.png" /></p>
<p>class 9变量重要性点图：
<img alt="" src="../_images/SC980_class9_feature_importance_summary_dot.png" /></p>
</li>
</ol>
</div>
<div class="section" id="cpu">
<span id="id9"></span><h4>CPU版本<a class="headerlink" href="#cpu" title="永久链接至标题">¶</a></h4>
<p>AutoGenome-BioGDL的使用主要包含以下几步：</p>
<ol>
<li><p class="first">导入autogenome_biogdl包</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">autogenome_biogdl</span> <span class="k">as</span> <span class="nn">ag_gdl</span>
</pre></div>
</div>
</li>
<li><p class="first">读取配置文件，配置文件如上述所示</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">automl_gdl</span> <span class="o">=</span> <span class="n">ag_gdl</span><span class="o">.</span><span class="n">auto</span><span class="p">(</span><span class="s2">&quot;./GeneGCN_single_cell_expression_ppi.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>配置文件读取成功后，会打印如下日志：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>==========================================================
----------Use the config from ./GeneGCN_single_cell_expression_ppi.yaml
----------Split parameters for autosearch and GDL
----------Build gcn extensions
----------Split yamls for autosearch
==========================================================
#################################################################################
#                                                                               #
#                                                                               #
         Ready to search the best hyper parameters for SC980 GeneGCN model
#                                                                               #
#                                                                               #
#################################################################################
</pre></div>
</div>
</li>
<li><p class="first">训练模型。根据配置文件中训练参数进行模型训练，将数据集划分为训练集:验证集为8:2，使用训练集数据进行训练，同时在验证集数据上进行评估，保存在验证集数据上评价指标（trainer.metrics: &#8220;acc&#8221;）更好的模型和参数到相应文件夹（trainer.train_url: &#8220;/home/wenshen/try_res&#8221;）中的<code class="docutils literal"><span class="pre">models</span></code>文件夹中。</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">automl_gdl</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
<p>训练过程中，使用autosearch搭配两种算法（random search和mbnas）对learning_rate, weight_decay, activation, num_layers, embedding_dim, channels进行最优参数搜索，每一种参数组合会训练一定的epoch数（trainer.num_epochs），挑选结果最好的作为最终模型结构参数并保存，训练过程中在验证集上进行评估。</p>
<p>训练过程中部分日志如下:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>----------In Hyper &amp; Training Search stage
platform.python_version(): 3.6.10
Results writing to local_dir : /mnt/data3/wenshen/SC980/result_cpu/autosearch_results/9d582a88-fbec-11ea-9693-9b5c05ab9893
Log dir is made: /mnt/data3/wenshen/SC980/result_cpu/autosearch_results/9d582a88-fbec-11ea-9693-9b5c05ab9893
[2020-09-21 17:27:08,637][search_policy.py: 181][WARNING]  Restore directory missing, AutoSearch will start without warm boot.
{&#39;learning_rate&#39;: 0.003, &#39;weight_decay&#39;: 0.0001}
{&#39;learning_rate&#39;: 0.005, &#39;weight_decay&#39;: 0.0001}
{&#39;learning_rate&#39;: 0.004, &#39;weight_decay&#39;: 1e-05}
{&#39;learning_rate&#39;: 0.002, &#39;weight_decay&#39;: 1e-05}
{&#39;learning_rate&#39;: 0.004, &#39;weight_decay&#39;: 0.001}
== Status ==
Memory usage on this node: 14.4/62.9 GiB
Using FIFO scheduling algorithm.
Resources requested: 8/8 CPUs, 0/1 GPUs, 0.0/62.89 GiB heap, 0.0/4.3 GiB objects
Result logdir: /mnt/data3/wenshen/SC980/result_cpu/autosearch_results/9d582a88-fbec-11ea-9693-9b5c05ab9893/ModelartsFunctionRunner
Number of trials: 5 (1 RUNNING, 4 PENDING)
+----------------------------------+----------+-------+-----------------+----------------+
| Trial name                       | status   | loc   | learning_rate   | weight_decay   |
|----------------------------------+----------+-------+-----------------+----------------|
| ModelartsFunctionRunner_9f24560c | RUNNING  |       |                 |                |
| ModelartsFunctionRunner_9f2486d6 | PENDING  |       |                 |                |
| ModelartsFunctionRunner_9f24b73c | PENDING  |       |                 |                |
| ModelartsFunctionRunner_9f25a73c | PENDING  |       |                 |                |
| ModelartsFunctionRunner_9f25cd5c | PENDING  |       |                 |                |
+----------------------------------+----------+-------+-----------------+----------------+
 ...
</pre></div>
</div>
</li>
</ol>
<ol>
<li><p class="first">评估模型。根据上步所训练的模型结构及模型参数，评估在<code class="docutils literal"><span class="pre">data.test_sample_file</span></code>和<code class="docutils literal"><span class="pre">data.test_label_file</span></code>上表现，分类模型输出<code class="docutils literal"><span class="pre">accuracy</span></code>值, <code class="docutils literal"><span class="pre">classification_report</span></code>和<code class="docutils literal"><span class="pre">confusion</span> <span class="pre">matrix</span></code>。</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">automl_gdl</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
</pre></div>
</div>
<p>部分日志如下所示：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>----------In Evaluation stage
New DB Info: /mnt/data3/wenshen/SC980/result_cpu/models/SC980/0921_172615/bbaf042e/bbaf042e_model/adjlist
start loading graph /mnt/data3/wenshen/SC980/result_cpu/models/SC980/0921_172615/bbaf042e/bbaf042e_model/adjlist
finish loading.
number of nodes = 5129
number of edges = 20691
time of loading graph = 6.17976 ms
INFO:tensorflow:Restoring parameters from /mnt/data3/wenshen/SC980/result_cpu/models/SC980/0921_172615/bbaf042e/bbaf042e_model/variables/variables
INFO:tensorflow:Restoring parameters from /mnt/data3/wenshen/SC980/result_cpu/models/SC980/0921_172615/bbaf042e/bbaf042e_model/variables/variables
INFO:root:metrics acc:0.924
INFO:root:The detail metrics is:
{&#39;0&#39;: {&#39;precision&#39;: 0.9042553191489362, &#39;recall&#39;: 0.85, &#39;f1-score&#39;: 0.8762886597938143, &#39;support&#39;: 100}, &#39;1&#39;: {&#39;precision&#39;: 0.8846153846153846, &#39;recall&#39;: 0.92, &#39;f1-score&#39;: 0.9019607843137256, &#39;support&#39;: 100}, &#39;2&#39;: {&#39;precision&#39;: 0.8723404255319149, &#39;recall&#39;: 0.82, &#39;f1-score&#39;: 0.8453608247422681, &#39;support&#39;: 100}, &#39;3&#39;: {&#39;precision&#39;: 0.9607843137254902, &#39;recall&#39;: 0.98, &#39;f1-score&#39;: 0.9702970297029702, &#39;support&#39;: 100}, &#39;4&#39;: {&#39;precision&#39;: 0.92, &#39;recall&#39;: 0.92, &#39;f1-score&#39;: 0.92, &#39;support&#39;: 100}, &#39;5&#39;: {&#39;precision&#39;: 0.8691588785046729, &#39;recall&#39;: 0.93, &#39;f1-score&#39;: 0.8985507246376813, &#39;support&#39;: 100}, &#39;6&#39;: {&#39;precision&#39;: 0.9320388349514563, &#39;recall&#39;: 0.96, &#39;f1-score&#39;: 0.9458128078817734, &#39;support&#39;: 100}, &#39;7&#39;: {&#39;precision&#39;: 0.9473684210526315, &#39;recall&#39;: 0.9, &#39;f1-score&#39;: 0.9230769230769231, &#39;support&#39;: 100}, &#39;8&#39;: {&#39;precision&#39;: 0.9504950495049505, &#39;recall&#39;: 0.96, &#39;f1-score&#39;: 0.9552238805970149, &#39;support&#39;: 100}, &#39;9&#39;: {&#39;precision&#39;: 1.0, &#39;recall&#39;: 1.0, &#39;f1-score&#39;: 1.0, &#39;support&#39;: 100}, &#39;accuracy&#39;: 0.924, &#39;macro avg&#39;: {&#39;precision&#39;: 0.9241056627035438, &#39;recall&#39;: 0.9239999999999998, &#39;f1-score&#39;: 0.923657163474617, &#39;support&#39;: 1000}, &#39;weighted avg&#39;: {&#39;precision&#39;: 0.9241056627035437, &#39;recall&#39;: 0.924, &#39;f1-score&#39;: 0.923657163474617, &#39;support&#39;: 1000}}
INFO:auto:----------Save evaluation results under /mnt/data3/wenshen/SC980/result_cpu/output_files/SC980/0921_172615
INFO:numexpr.utils:NumExpr defaulting to 8 threads.
INFO:auto:Confusion matrix plot is &#39;/mnt/data3/wenshen/SC980/result_cpu/output_files/SC980/0921_172615/SC980_confusion_matrix.pdf/png&#39;
</pre></div>
</div>
<p>evaluate阶段将输出评估的<code class="docutils literal"><span class="pre">classification_report</span></code>csv文件和<code class="docutils literal"><span class="pre">confusion_matrix</span></code>csv/png/pdf文件，保存到<code class="docutils literal"><span class="pre">output_files</span></code>文件夹中。</p>
<p>得到的confusion matrix图如下所示，图数字大小会根据类别数多少进行调整，x轴为真值，y轴为预测值：</p>
<p><img alt="" src="../_images/SC980_confusion_matrix.png" /></p>
</li>
<li><p class="first">预测数据。根据第3步所训练的模型结构及模型参数，对于给定features数据（<code class="docutils literal"><span class="pre">data.predict_sample_file</span></code>），分类问题预测其类别，并输出到对应的csv文件中。</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">automl_gdl</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
</pre></div>
</div>
<p>日志如下所示：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span>INFO:auto:----------In Prediction stage
New DB Info: /mnt/data3/wenshen/SC980/result_cpu/models/SC980/0921_172615/bbaf042e/bbaf042e_model/adjlist
start loading graph /mnt/data3/wenshen/SC980/result_cpu/models/SC980/0921_172615/bbaf042e/bbaf042e_model/adjlist
finish loading.
number of nodes = 5129
number of edges = 20691
time of loading graph = 8.89547 ms
INFO:tensorflow:Restoring parameters from /mnt/data3/wenshen/SC980/result_cpu/models/SC980/0921_172615/bbaf042e/bbaf042e_model/variables/variables
INFO:tensorflow:Restoring parameters from /mnt/data3/wenshen/SC980/result_cpu/models/SC980/0921_172615/bbaf042e/bbaf042e_model/variables/variables
INFO:auto:----------Save prediction results in /mnt/data3/wenshen/SC980/result_cpu/output_files/SC980/0921_172615/SC980_predicted_result_data_frame.csv
</pre></div>
</div>
<p>如日志所示，将输出预测的<code class="docutils literal"><span class="pre">predicted_result_data_frame</span></code>文件，文件第一列为样本名，第二列<code class="docutils literal"><span class="pre">predicted_result</span></code>为预测的类别，其余列为各个类别的log_softmax值。</p>
</li>
<li><p class="first">变量重要性排序。根据第3步所训练的模型结构及模型参数，对变量重要性进行排序，输出各个类别变量重要性，<code class="docutils literal"><span class="pre">explainer</span></code>中需要指定变量名对应的文件。</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">automl_gdl</span><span class="o">.</span><span class="n">explain</span><span class="p">()</span>
</pre></div>
</div>
<p>对模型变量重要性进行排序，输出日志如下：</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="o">----------</span><span class="nx">In</span> <span class="nx">explaination</span> <span class="nx">stage</span>
<span class="nx">Restoring</span> <span class="nx">parameters</span> <span class="kr">from</span> <span class="o">/</span><span class="nx">mnt</span><span class="o">/</span><span class="nx">data3</span><span class="o">/</span><span class="nx">wenshen</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="nx">result</span><span class="o">/</span><span class="nx">models</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="mf">0921</span><span class="nx">_164750</span><span class="o">/</span><span class="nx">d465c6d0</span><span class="o">/</span><span class="nx">d465c6d0_model</span><span class="o">/</span><span class="nx">variables</span><span class="o">/</span><span class="nx">variables</span>
<span class="nx">Restoring</span> <span class="nx">parameters</span> <span class="kr">from</span> <span class="o">/</span><span class="nx">mnt</span><span class="o">/</span><span class="nx">data3</span><span class="o">/</span><span class="nx">wenshen</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="nx">result</span><span class="o">/</span><span class="nx">models</span><span class="o">/</span><span class="nx">SC980</span><span class="o">/</span><span class="mf">0921</span><span class="nx">_164750</span><span class="o">/</span><span class="nx">d465c6d0</span><span class="o">/</span><span class="nx">d465c6d0_model</span><span class="o">/</span><span class="nx">variables</span><span class="o">/</span><span class="nx">variables</span>
<span class="nx">Using</span> <span class="nx">TensorFlow</span> <span class="nx">backend</span><span class="p">.</span>
<span class="o">----------</span><span class="nx">Computing</span> <span class="nx">shap_values</span> <span class="kd">with</span> <span class="mf">500</span>  <span class="nx">examples</span> <span class="nx">and</span> <span class="mf">5129</span> <span class="nx">features</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class0_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class1_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class2_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class3_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class4_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class5_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class6_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class7_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class8_shap_values.csv&#39;</span>
<span class="nx">shap_values</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class9_shap_values.csv&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class0_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class1_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class2_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class3_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class4_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class5_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class6_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class7_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class8_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class9_feature_importance_summary_dot.pdf/png&#39;</span>
<span class="nx">features</span> <span class="nx">orders</span> <span class="ow">in</span> <span class="nx">all</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="nx">saved</span> <span class="ow">in</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_features_orders.csv&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class1_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class3_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class6_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class2_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class8_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class0_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class4_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class5_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class7_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">classes</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_class9_feature_importance_summary.pdf/png&#39;</span>
<span class="nx">importance</span> <span class="nx">plot</span> <span class="nx">is</span> <span class="s1">&#39;/mnt/data3/wenshen/SC980/result/output_files/SC980/0921_164750/SC980_classTotal_feature_importance_summary_bar.pdf/png&#39;</span>
</pre></div>
</div>
<p>运行结束后将输出各个类别的变量重要性条图和点图和总的变量重要性图，如下所示：</p>
<p>总的变量重要性图：</p>
<p><img alt="" src="../_images/SC980_classTotal_feature_importance_summary_bar.png" /></p>
<p>class 0变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class0_feature_importance_summary.png" /></p>
<p>class 1变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class1_feature_importance_summary.png" /></p>
<p>class 2变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class2_feature_importance_summary.png" /></p>
<p>class 3变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class3_feature_importance_summary.png" /></p>
<p>class 4变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class4_feature_importance_summary.png" /></p>
<p>class 5变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class5_feature_importance_summary.png" /></p>
<p>class 6变量重要性条图：</p>
<p><img alt="" src="../_images/Pancancer-SC980_class6_feature_importance_summary.png" /></p>
<p>class 7变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class7_feature_importance_summary.png" /></p>
<p>class 8变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class8_feature_importance_summary.png" /></p>
<p>class 9变量重要性条图：</p>
<p><img alt="" src="../_images/SC980_class9_feature_importance_summary.png" /></p>
<p>class 0变量重要性点图：</p>
<p><img alt="" src="../_images/SC980_class0_feature_importance_summary_dot.png" /></p>
<p>class 1变量重要性点图：
<img alt="" src="../_images/SC980_class1_feature_importance_summary_dot.png" /></p>
<p>class 2变量重要性点图：</p>
<p><img alt="" src="../_images/SC980_class2_feature_importance_summary_dot.png" /></p>
<p>class 3变量重要性点图：
<img alt="" src="../_images/SC980_class3_feature_importance_summary_dot.png" /></p>
<p>class 4变量重要性点图：</p>
<p><img alt="" src="../_images/SC980_class4_feature_importance_summary_dot.png" /></p>
<p>class 5变量重要性点图：
<img alt="" src="../_images/SC980_class5_feature_importance_summary_dot.png" /></p>
<p>class 6变量重要性点图：</p>
<p><img alt="" src="../_images/SC980_class6_feature_importance_summary_dot.png" /></p>
<p>class 7变量重要性点图：
<img alt="" src="../_images/SC980_class7_feature_importance_summary_dot.png" /></p>
<p>class 8变量重要性点图：</p>
<p><img alt="" src="../_images/SC980_class8_feature_importance_summary_dot.png" /></p>
<p>class 9变量重要性点图：
<img alt="" src="../_images/SC980_class9_feature_importance_summary_dot.png" /></p>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="">
<span id="id10"></span><h2>附录<a class="headerlink" href="#" title="永久链接至标题">¶</a></h2>
<p>AutoGGN文章：<a class="reference external" href="https://doi.org/10.1016/j.ailsci.2021.100019">AutoGGN: A gene graph network AutoML tool for multi-omics research</a></p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../AutoOmics/AutoOmics.html" class="btn btn-neutral" title="AutoOmics" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; 版权所有 2021, Huawei.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>